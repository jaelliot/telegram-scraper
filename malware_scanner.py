import clamd

# Connect to ClamAV daemon for malware scanning
try:
    clamd_client = clamd.ClamdNetworkSocket()
except Exception as e:
    print("Failed to connect to ClamAV:", e)
    exit(1)

def check_for_malware(file_path):
    scan_result = clamd_client.scan(file_path)
    if scan_result and scan_result[file_path][0] == 'FOUND':
        return True
    return False
